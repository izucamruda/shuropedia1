<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å - –©—É—Ä–æ–ø–µ–¥–∏—è</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <header>
        <h1><a href="/">–©—É—Ä–æ–ø–µ–¥–∏—è</a></h1>
        <div class="auth-links">
            <span>üîß –ê–¥–º–∏–Ω: <strong><%= user %></strong></span>
            <form method="POST" action="/logout" style="display: inline;">
                <button type="submit" style="background: #dc3545;">üö™ –í—ã–π—Ç–∏</button>
            </form>
            <a href="/" style="background: #6c757d; color: white; padding: 0.5rem 1rem; border-radius: 6px; text-decoration: none;">üè† –ù–∞ —Å–∞–π—Ç</a>
        </div>
    </header>
    <main>
        <div class="admin-panel-container">
            <h2>üîß –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –©—É—Ä–æ–ø–µ–¥–∏–µ–π</h2>
            
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="admin-stats">
                <div class="stat-card">
                    <span class="stat-number"><%= articles.length %></span>
                    <span class="stat-label">–í—Å–µ–≥–æ —Å—Ç–∞—Ç–µ–π</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number"><%= articles.filter(a => a.views > 0).length %></span>
                    <span class="stat-label">–ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º—ã—Ö</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number"><%= new Date().toLocaleDateString() %></span>
                    <span class="stat-label">–°–µ–≥–æ–¥–Ω—è</span>
                </div>
            </div>

            <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
            <div class="admin-section">
                <h3>‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
                <div class="admin-actions">
                    <a href="/create" class="admin-btn">üìù –°–æ–∑–¥–∞—Ç—å —Å—Ç–∞—Ç—å—é</a>
                    <a href="/categories" class="admin-btn">üìÇ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏</a>
                    <a href="/" class="admin-btn">üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–∞–π—Ç</a>
                </div>
            </div>

            <!-- –í—Å–µ —Å—Ç–∞—Ç—å–∏ -->
            <div class="admin-section">
                <h3>üìö –í—Å–µ —Å—Ç–∞—Ç—å–∏ (<%= articles.length %>)</h3>
                <% if (articles.length > 0) { %>
                    <div class="articles-list">
                        <% articles.forEach(function(article) { %>
                            <div class="article-item" style="background: white; padding: 1.5rem; margin: 1rem 0; border-radius: 8px; border-left: 4px solid #36c;">
                                <div class="article-info">
                                    <strong style="font-size: 1.2rem;">
                                        <a href="/article/<%= article.title %>" style="color: #36c; text-decoration: none;">
                                            <%= article.title %>
                                        </a>
                                    </strong>
                                    <div style="margin-top: 0.5rem; color: #666;">
                                        <span>üìÖ <%= new Date(article.created_at).toLocaleDateString() %></span>
                                        <span> | üëÅÔ∏è <%= article.views || 0 %> –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</span>
                                        <span> | üîÑ <%= new Date(article.updated_at).toLocaleDateString() %></span>
                                    </div>
                                </div>
                                <div class="article-actions" style="margin-top: 1rem; display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <a href="/edit/<%= article.title %>" class="admin-btn" style="padding: 0.5rem 1rem; font-size: 0.9rem;">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                                    <a href="/history/<%= article.title %>" class="admin-btn" style="padding: 0.5rem 1rem; font-size: 0.9rem; background: #6c757d;">üìú –ò—Å—Ç–æ—Ä–∏—è</a>
                                    <form method="POST" action="/delete/<%= article.title %>" style="display: inline;">
                                        <button type="submit" class="admin-btn danger" style="padding: 0.5rem 1rem; font-size: 0.9rem;" 
                                                onclick="return confirm('–¢–æ—á–Ω–æ —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ç—å—é ¬´<%= article.title %>¬ª?')">
                                            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                                        </button>
                                    </form>
                                </div>
                            </div>
                        <% }); %>
                    </div>
                <% } else { %>
                    <div style="text-align: center; padding: 3rem; color: #666;">
                        <p style="font-size: 1.2rem;">üì≠ –°—Ç–∞—Ç–µ–π –ø–æ–∫–∞ –Ω–µ—Ç</p>
                        <a href="/create" class="admin-btn" style="display: inline-block; margin-top: 1rem;">–°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—É—é —Å—Ç–∞—Ç—å—é</a>
                    </div>
                <% } %>
            </div>

            <!-- –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div class="admin-section">
                <h3>üñ•Ô∏è –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                <div style="background: white; padding: 1.5rem; border-radius: 8px;">
                    <p><strong>–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:</strong> SQLite</p>
                    <p><strong>–°—Ç–∞—Ç–µ–π –≤ –±–∞–∑–µ:</strong> <%= articles.length %></p>
                    <p><strong>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:</strong> <%= new Date().toLocaleString() %></p>
                </div>
            </div>
        </div>
    </main>

    <div class="theme-switcher">
        <button class="theme-toggle" onclick="toggleTheme()">üåô</button>
    </div>

    <script>
    function toggleTheme() {
        document.body.classList.toggle('dark-theme');
        const isDark = document.body.classList.contains('dark-theme');
        localStorage.setItem('darkTheme', isDark);
        document.querySelector('.theme-toggle').textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
    }

    if (localStorage.getItem('darkTheme') === 'true') {
        document.body.classList.add('dark-theme');
        document.querySelector('.theme-toggle').textContent = '‚òÄÔ∏è';
    }
    </script>
</body>
</html>