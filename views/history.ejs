<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò—Å—Ç–æ—Ä–∏—è: <%= title %> - –©—É—Ä–æ–ø–µ–¥–∏—è</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <header>
        <h1><a href="/">–©—É—Ä–æ–ø–µ–¥–∏—è</a></h1>
        <div class="user-info">
            <% if (user) { %>
                –í—ã –≤–æ—à–ª–∏ –∫–∞–∫: <strong><%= user %></strong>
                <form method="POST" action="/logout" style="display: inline;">
                    <button type="submit">–í—ã–π—Ç–∏</button>
                </form>
            <% } else { %>
    <a href="/admin">üîê –í—Ö–æ–¥ –∞–¥–º–∏–Ω–∞</a>
<% } %>
        </div>
    </header>
    <main>
        <div class="history-container">
            <h2>–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π: <%= title %></h2>
            <p><a href="/article/<%= title %>">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å—Ç–∞—Ç—å–µ</a></p>
            
            <div class="history-list">
                <% history.forEach(function(version) { %>
                    <div class="history-item">
                        <div class="history-header">
                            <strong>–í–µ—Ä—Å–∏—è –æ—Ç <%= new Date(version.created_at).toLocaleString() %></strong>
                            <span>–ê–≤—Ç–æ—Ä: <%= version.username || '–ù–µ–∏–∑–≤–µ—Å—Ç–µ–Ω' %></span>
                        </div>
                        <div class="history-content">
                            <pre><%= version.content.substring(0, 200) %>...</pre>
                        </div>
                        <% if (user) { %>
                            <form method="POST" action="/restore/<%= version.id %>" style="display: inline;">
                                <button type="submit" class="restore-btn">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —ç—Ç—É –≤–µ—Ä—Å–∏—é</button>
                            </form>
                        <% } %>
                    </div>
                <% }); %>
            </div>
        </div>
    </main>
	<div class="theme-switcher">
    <button class="theme-toggle" onclick="toggleTheme()">üåô</button>
</div>

<script>
function toggleTheme() {
    document.body.classList.toggle('dark-theme');
    const isDark = document.body.classList.contains('dark-theme');
    localStorage.setItem('darkTheme', isDark);
    document.querySelector('.theme-toggle').textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
}

// –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–º—ã –∏–∑ localStorage
if (localStorage.getItem('darkTheme') === 'true') {
    document.body.classList.add('dark-theme');
    document.querySelector('.theme-toggle').textContent = '‚òÄÔ∏è';
}
</script>
</body>
</html>